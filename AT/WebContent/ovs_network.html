<!-- Loads and initializes the library -->
<script type="text/javascript">
 var mxBasePath = "mxgraph";
</script>
<script type="text/javascript" src="mxgraph/js/mxClient.js"></script>

<script type="text/javascript">
		// Program starts here. Creates a sample graph in the
		// DOM node with the specified ID. This function is invoked
		// from the onLoad event handler of the document (see below).
		
		var graph;
		var keyHandler;
		var focusedCell;
		
		function main(container)
		{
			// Checks if the browser is supported
			if (!mxClient.isBrowserSupported())
			{
				// Displays an error message if the browser is not supported.
				mxUtils.error('Browser is not supported!', 200, false);
			}
			else
			{
				// Disables the built-in context menu
				mxEvent.disableContextMenu(container);
				
				// Creates the graph inside the given container
				graph = new mxGraph(container);
				
				// Gets the default parent for inserting new cells. This
				// is normally the first child of the root (ie. layer 0).
				var parent = graph.getDefaultParent();
				
				keyHandler = new mxKeyHandler(graph);
				keyHandler.bindKey(46, function(evt){
					if (graph.isEnabled()){
						if(graph.getSelectionCell().isEdge())
							graph.removeCells();
					}
				});
								
				// Adds cells to the model in a single step
				graph.setConnectable(true);
				graph.setAllowDanglingEdges(false);
				graph.cellsResizable = false;
				
				var style = graph.getStylesheet().getDefaultEdgeStyle();
				style["startArrow"] = "none";
				style["endArrow"] = "none";
				
				graph.getModel().beginUpdate();
				try
				{
					var v1 = graph.insertVertex(parent, null, 'Hello,', 20, 20, 100, 50);
					var v2 = graph.insertVertex(parent, null, 'World!', 200, 150, 100, 50);
					var v3 = graph.insertVertex(parent, null, 'pasquale!', 150, 200, 100, 50);
					var e1 = graph.insertEdge(parent, null, '', v1, v2);
					var e2 = graph.insertEdge(parent, null, '', v3, v2);
					
				}
				finally
				{
					// Updates the display
					graph.getModel().endUpdate();
				}
				
				
			}
		};
	
</script>

<script>
$(document).ready(function(){
	main(document.getElementById('graphContainer'));
	
	/*if (mxClient.IS_NS)
	{
	  mxEvent.addListener(graph.container, 'mousedown', function()
	  {
	    if (!graph.isEditing())
	    {
	      graph.container.setAttribute('tabindex', '-1');
	      graph.container.focus();
	    }
	  });
	}*/
}); 

$( "#sendChangesB" ).button().click(function( event ) {
	var encoder = new mxCodec();
	var result = encoder.encode(graph.getModel());
	var xml = mxUtils.getXml(result);
	console.log("TA-DAN!");
	console.log(xml);
});
</script>

<button id="sendChangesB">get xml!</button>

<div id="graphContainer">
</div>
	

	
	